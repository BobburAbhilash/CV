<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing Mplus and mclust output • tidyLPA</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tidyLPA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->


      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Comparing Mplus and mclust output</h1>
                        <h4 class="author">Joshua Rosenberg</h4>

            <h4 class="date">2018-01-16</h4>
          </div>



<div class="contents">
<p>This vignette compares mclust and Mplus output, for the purpose of benchmarking the use of mclust, an open-source tool, to Mplus. Note that for the <code><a href="../reference/create_profiles_mplus.html">create_profiles_mplus()</a></code> function to work, you must have Mplus installed (and purchased).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyLPA)</code></pre></div>
<pre><code>#&gt; Loading tidyLPA</code></pre>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code><a href="../reference/create_profiles_lpa.html">create_profiles_lpa()</a></code> uses the mclust R package, while <code><a href="../reference/create_profiles_mplus.html">create_profiles_mplus()</a></code> generates Mplus model syntax which is then run with Mplus.</p>
<p>When <code><a href="../reference/create_profiles_mplus.html">create_profiles_mplus()</a></code> is used, a number of files (<code>.dat</code> for the data, <code>.inp</code> for the model syntax, and <code>.out</code> for the model output) will be generated in your working directory. In future versions, these will be generated into a temporary directory by default). For example, when the following line of code is run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span></code></pre></div>
<p>The <code>t.inp</code> file is saved in your working directory with the following contents. Note that this code is likely different because it is generated programmatically and uses no defaults (it is likely less efficient than code that you would write by hand).</p>
<pre><code>TITLE: test
DATA: File is d.dat;
VARIABLE:
Names are Sepal_Length Sepal_Width Petal_Length Petal_Width;
Classes = c(2);
MODEL:
%overall%
[Sepal_Length Sepal_Width Petal_Length Petal_Width];
Sepal_Length Sepal_Width Petal_Length Petal_Width;
Sepal_Length WITH Sepal_Width@0;
Sepal_Length WITH Petal_Length@0;
Sepal_Length WITH Petal_Width@0;
Sepal_Width WITH Petal_Length@0;
Sepal_Width WITH Petal_Width@0;
Petal_Length WITH Petal_Width@0;
%c#1%
[Sepal_Length Sepal_Width Petal_Length Petal_Width];
Sepal_Length Sepal_Width Petal_Length Petal_Width(1-4);
Sepal_Length WITH Sepal_Width@0;
Sepal_Length WITH Petal_Length@0;
Sepal_Length WITH Petal_Width@0;
Sepal_Width WITH Petal_Length@0;
Sepal_Width WITH Petal_Width@0;
Petal_Length WITH Petal_Width@0;
%c#2%
[Sepal_Length Sepal_Width Petal_Length Petal_Width];
Sepal_Length Sepal_Width Petal_Length Petal_Width(1-4);
Sepal_Length WITH Sepal_Width@0;
Sepal_Length WITH Petal_Length@0;
Sepal_Length WITH Petal_Width@0;
Sepal_Width WITH Petal_Length@0;
Sepal_Width WITH Petal_Width@0;
Petal_Length WITH Petal_Width@0;
ANALYSIS: Type is mixture;
OUTPUT: TECH1 TECH11;</code></pre>
<p>We can see how this syntax changes if we change the function’s arguments by removing a variable, increasing the number of profiles, and changing the model that is specified:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>
m1_mplus<span class="op">$</span>summaries<span class="op">$</span>LL
<span class="co">#&gt; NULL</span></code></pre></div>
<pre><code>TITLE: test
DATA: File is d.dat;
VARIABLE:
Names are Sepal_Length Sepal_Width Petal_Length;
Classes = c(3);
MODEL:
%overall%
[Sepal_Length Sepal_Width Petal_Length];
Sepal_Length Sepal_Width Petal_Length;
Sepal_Length WITH Sepal_Width;
Sepal_Length WITH Petal_Length;
Sepal_Width WITH Petal_Length;
%c#1%
[Sepal_Length Sepal_Width Petal_Length];
Sepal_Length Sepal_Width Petal_Length(1-3);
Sepal_Length WITH Sepal_Width(4);
Sepal_Length WITH Petal_Length(5);
Sepal_Width WITH Petal_Length(6);
%c#2%
[Sepal_Length Sepal_Width Petal_Length];
Sepal_Length Sepal_Width Petal_Length(1-3);
Sepal_Length WITH Sepal_Width(4);
Sepal_Length WITH Petal_Length(5);
Sepal_Width WITH Petal_Length(6);
%c#3%
[Sepal_Length Sepal_Width Petal_Length];
Sepal_Length Sepal_Width Petal_Length(1-3);
Sepal_Length WITH Sepal_Width(4);
Sepal_Length WITH Petal_Length(5);
Sepal_Width WITH Petal_Length(6);
ANALYSIS: Type is mixture;
OUTPUT: TECH1 TECH11;</code></pre>
<p>In the rest of this document, Mplus and mclust are benchmarked. For ease of comparison, the estimated log-likelihood; if these are identical it probably means all of the estimated paramteters are identical (<a href="https://jrosen48.github.io/blog/comparing-mplus-and-mclust-output/">other benchmarks we have done</a> with Mplus and mclust have demonstrated this).</p>
</div>
<div id="using-the-built-in-iris-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#using-the-built-in-iris-dataset" class="anchor"></a>Using the built-in iris dataset</h1>
<div id="profiles" class="section level3">
<h3 class="hasAnchor">
<a href="#profiles" class="anchor"></a>2 profiles</h3>
<p><strong>Mplus</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>
m1_mplus<span class="op">$</span>summaries<span class="op">$</span>LL
<span class="co">#&gt; NULL</span>

m2_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>
m2_mplus<span class="op">$</span>summaries<span class="op">$</span>LL
<span class="co">#&gt; NULL</span>

m3_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m3_mplus<span class="op">$</span>summaries<span class="op">$</span>LL
<span class="co">#&gt; NULL</span>

m4_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">4</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m4_mplus<span class="op">$</span>summaries<span class="op">$</span>LL
<span class="co">#&gt; NULL</span>

m5_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m5_mplus<span class="op">$</span>summaries<span class="op">$</span>LL
<span class="co">#&gt; NULL</span></code></pre></div>
<p><strong>mclust</strong></p>
<p>Note that model 4 can only be specified in Mplus, so is not included here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 488.915</span>
<span class="co">#&gt; AIC is 1003.83</span>
<span class="co">#&gt; CAIC is 1055.968</span>
<span class="co">#&gt; BIC is 1042.968</span>
<span class="co">#&gt; SABIC is 1001.825</span>
<span class="co">#&gt; ICL is 1043.542</span>
<span class="co">#&gt; Entropy is 0.998</span>

m2_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 296.448</span>
<span class="co">#&gt; AIC is 630.895</span>
<span class="co">#&gt; CAIC is 707.097</span>
<span class="co">#&gt; BIC is 688.097</span>
<span class="co">#&gt; SABIC is 627.966</span>
<span class="co">#&gt; ICL is 688.099</span>
<span class="co">#&gt; Entropy is 1</span>

m3_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; Fit varying means and variances, covariances fixed to 0 (Model 3) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 386.185</span>
<span class="co">#&gt; AIC is 806.371</span>
<span class="co">#&gt; CAIC is 874.551</span>
<span class="co">#&gt; BIC is 857.551</span>
<span class="co">#&gt; SABIC is 803.75</span>
<span class="co">#&gt; ICL is 857.552</span>
<span class="co">#&gt; Entropy is 1</span>

m5_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; Fit varying means, variances, and covariances (Model 4) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 214.355</span>
<span class="co">#&gt; AIC is 486.709</span>
<span class="co">#&gt; CAIC is 603.018</span>
<span class="co">#&gt; BIC is 574.018</span>
<span class="co">#&gt; SABIC is 482.238</span>
<span class="co">#&gt; ICL is 574.019</span>
<span class="co">#&gt; Entropy is 1</span></code></pre></div>
<p>Here is a summary of the log-likelihood statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tibble)

iris_log_lik &lt;-<span class="st"> </span><span class="kw">tribble</span>(
    <span class="op">~</span>model, <span class="op">~</span>mplus, <span class="op">~</span>mclust,
    <span class="dv">1</span>, <span class="fl">488.915</span>, <span class="fl">488.915</span>,
    <span class="dv">2</span>, <span class="fl">296.448</span>, <span class="fl">296.448</span>,
    <span class="dv">3</span>, <span class="fl">386.185</span>, <span class="fl">386.185</span>,
    <span class="dv">4</span>, <span class="fl">278.544</span>, <span class="ot">NA</span>,
    <span class="dv">5</span>, <span class="fl">214.355</span>, <span class="fl">214.355</span>
)

iris_log_lik
<span class="co">#&gt; # A tibble: 5 x 3</span>
<span class="co">#&gt;   model mplus mclust</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1  1.00   489    489</span>
<span class="co">#&gt; 2  2.00   296    296</span>
<span class="co">#&gt; 3  3.00   386    386</span>
<span class="co">#&gt; 4  4.00   279     NA</span>
<span class="co">#&gt; 5  5.00   214    214</span></code></pre></div>
</div>
<div id="profiles-1" class="section level3">
<h3 class="hasAnchor">
<a href="#profiles-1" class="anchor"></a>3 profiles</h3>
<p>What if we specify 3 profiles?</p>
<p><strong>Mplus</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m2_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m3_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m4_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">4</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m5_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span></code></pre></div>
<p><strong>mclust</strong></p>
<p>Note that model 4 can only be specified in Mplus, so is not included here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                 <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 3 profiles.</span>
<span class="co">#&gt; LogLik is 361.429</span>
<span class="co">#&gt; AIC is 758.859</span>
<span class="co">#&gt; CAIC is 831.05</span>
<span class="co">#&gt; BIC is 813.05</span>
<span class="co">#&gt; SABIC is 756.084</span>
<span class="co">#&gt; ICL is 820.771</span>
<span class="co">#&gt; Entropy is 0.979</span>

m2_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                 <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 3 profiles.</span>
<span class="co">#&gt; LogLik is 256.355</span>
<span class="co">#&gt; AIC is 560.709</span>
<span class="co">#&gt; CAIC is 656.965</span>
<span class="co">#&gt; BIC is 632.965</span>
<span class="co">#&gt; SABIC is 557.009</span>
<span class="co">#&gt; ICL is 637.84</span>
<span class="co">#&gt; Entropy is 0.985</span>

m3_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                 <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; Fit varying means and variances, covariances fixed to 0 (Model 3) model with 3 profiles.</span>
<span class="co">#&gt; LogLik is 307.181</span>
<span class="co">#&gt; AIC is 666.362</span>
<span class="co">#&gt; CAIC is 770.638</span>
<span class="co">#&gt; BIC is 744.638</span>
<span class="co">#&gt; SABIC is 662.353</span>
<span class="co">#&gt; ICL is 751.816</span>
<span class="co">#&gt; Entropy is 0.979</span>

m5_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                 <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; Fit varying means, variances, and covariances (Model 4) model with 3 profiles.</span>
<span class="co">#&gt; LogLik is 180.186</span>
<span class="co">#&gt; AIC is 448.372</span>
<span class="co">#&gt; CAIC is 624.84</span>
<span class="co">#&gt; BIC is 580.84</span>
<span class="co">#&gt; SABIC is 441.588</span>
<span class="co">#&gt; ICL is 584.052</span>
<span class="co">#&gt; Entropy is 0.99</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tibble)

iris_log_lik_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">tribble</span>(
    <span class="op">~</span>model, <span class="op">~</span>mplus, <span class="op">~</span>mclust,
    <span class="dv">1</span>, <span class="fl">361.426</span>, <span class="fl">361.429</span>,
    <span class="dv">2</span>, <span class="fl">256.354</span>, <span class="fl">256.355</span>,
    <span class="dv">3</span>, <span class="fl">307.178</span>, <span class="fl">307.181</span>,
    <span class="dv">4</span>, <span class="fl">229.004</span>, <span class="ot">NA</span>,
    <span class="dv">5</span>, <span class="fl">180.185</span>, <span class="fl">180.186</span>
)

iris_log_lik_<span class="dv">3</span>
<span class="co">#&gt; # A tibble: 5 x 3</span>
<span class="co">#&gt;   model mplus mclust</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1  1.00   361    361</span>
<span class="co">#&gt; 2  2.00   256    256</span>
<span class="co">#&gt; 3  3.00   307    307</span>
<span class="co">#&gt; 4  4.00   229     NA</span>
<span class="co">#&gt; 5  5.00   180    180</span></code></pre></div>
</div>
</div>
<div id="using-the-built-in-old-faithful-geyser-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#using-the-built-in-old-faithful-geyser-dataset" class="anchor"></a>Using the built-in old faithful geyser dataset</h1>
<p><strong>Mplus</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m2_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m3_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m4_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">4</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span>

m5_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; This first list item is the model output and the second is the save data with class probabilities.</span></code></pre></div>
<p><strong>mclust</strong></p>
<p>Note that model 4 can only be specified in Mplus, so is not included here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(faithful,
                                 eruptions, waiting,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 1157.68</span>
<span class="co">#&gt; AIC is 2329.36</span>
<span class="co">#&gt; CAIC is 2361.601</span>
<span class="co">#&gt; BIC is 2354.601</span>
<span class="co">#&gt; SABIC is 2332.406</span>
<span class="co">#&gt; ICL is 2356.273</span>
<span class="co">#&gt; Entropy is 0.998</span>

m2_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(faithful,
                                 eruptions, waiting,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 1140.187</span>
<span class="co">#&gt; AIC is 2296.374</span>
<span class="co">#&gt; CAIC is 2333.22</span>
<span class="co">#&gt; BIC is 2325.22</span>
<span class="co">#&gt; SABIC is 2299.854</span>
<span class="co">#&gt; ICL is 2326.71</span>
<span class="co">#&gt; Entropy is 0.998</span>

m3_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(faithful,
                                 eruptions, waiting,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; Fit varying means and variances, covariances fixed to 0 (Model 3) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 1147.806</span>
<span class="co">#&gt; AIC is 2313.613</span>
<span class="co">#&gt; CAIC is 2355.065</span>
<span class="co">#&gt; BIC is 2346.065</span>
<span class="co">#&gt; SABIC is 2317.528</span>
<span class="co">#&gt; ICL is 2346.161</span>
<span class="co">#&gt; Entropy is 1</span>

m5_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(faithful,
                                 eruptions, waiting,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; Fit varying means, variances, and covariances (Model 4) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 1130.264</span>
<span class="co">#&gt; AIC is 2282.528</span>
<span class="co">#&gt; CAIC is 2333.192</span>
<span class="co">#&gt; BIC is 2322.192</span>
<span class="co">#&gt; SABIC is 2287.314</span>
<span class="co">#&gt; ICL is 2322.697</span>
<span class="co">#&gt; Entropy is 0.999</span></code></pre></div>
<p>Here is a summary of the log-likelihood statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tibble)

geyser_log_lik &lt;-<span class="st"> </span><span class="kw">tribble</span>(
    <span class="op">~</span>model, <span class="op">~</span>mplus, <span class="op">~</span>mclust,
    <span class="dv">1</span>, <span class="fl">1157.68</span>, <span class="fl">1157.68</span>,
    <span class="dv">2</span>, <span class="fl">1140.187</span>, <span class="fl">1140.187</span>,
    <span class="dv">3</span>, <span class="fl">1147.806</span>, <span class="fl">1147.806</span>,
    <span class="dv">4</span>, <span class="fl">1131.970</span>, <span class="ot">NA</span>,
    <span class="dv">5</span>, <span class="fl">1130.264</span>, <span class="fl">1130.264</span>
)

geyser_log_lik
<span class="co">#&gt; # A tibble: 5 x 3</span>
<span class="co">#&gt;   model mplus mclust</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1  1.00  1158   1158</span>
<span class="co">#&gt; 2  2.00  1140   1140</span>
<span class="co">#&gt; 3  3.00  1148   1148</span>
<span class="co">#&gt; 4  4.00  1132     NA</span>
<span class="co">#&gt; 5  5.00  1130   1130</span></code></pre></div>
</div>
<div id="next-steps" class="section level1">
<h1 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next steps</h1>
<p>Finding conditions when the models do differ is an important consideration; these differences, when encountered, are probably due to two reasons:</p>
<ol style="list-style-type: decimal">
<li>Different initialization routines: Mplus uses random starts, and while mclust can use random starts, it defaults to using hierarchical clustering to initialize.</li>
<li>Different estimation methods: Both use Expectation-Maximization (EM) maximum likelihood estimation methods, though Mplus may use an estimator which is more robust to non-normal distributions.</li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#using-the-built-in-iris-dataset">Using the built-in iris dataset</a></li>
      <li><a href="#using-the-built-in-old-faithful-geyser-dataset">Using the built-in old faithful geyser dataset</a></li>
      <li><a href="#next-steps">Next steps</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joshua M Rosenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
